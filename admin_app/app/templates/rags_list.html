{% extends "base.html" %}
{% set title = "RAGs" %}
{% block content %}
<div class="container">
  <div class="mb-4">
    <h1 class="h1">RAGs</h1>
    <p class="p-muted">Collections / indexes overview with filters.</p>
  </div>

  <div class="card card-pad" style="margin-bottom:12px;">
    <form method="get" class="grid grid-4">
      <div>
        <label class="block mb-1 text-xs font-medium text-gray-700">Search</label>
        <input name="q" value="{{ filters.q }}" placeholder="name..." class="input">
      </div>
      <div>
        <label class="block mb-1 text-xs font-medium text-gray-700">Scope</label>
        <select name="scope" class="input">
          <option value="all" {{ "selected" if filters.scope=="all" else "" }}>all</option>
          <option value="global" {{ "selected" if filters.scope=="global" else "" }}>global</option>
          <option value="private" {{ "selected" if filters.scope=="private" else "" }}>private</option>
        </select>
      </div>
      <div>
        <label class="block mb-1 text-xs font-medium text-gray-700">Owner</label>
        <input name="owner" value="{{ '' if filters.owner=='all' else filters.owner }}" placeholder="user id..." class="input">
      </div>
      <div>
        <label class="block mb-1 text-xs font-medium text-gray-700">Embedding model</label>
        <select name="embed" class="input">
          <option value="all" {{ "selected" if filters.embed=="all" else "" }}>all</option>
          {% for m in embed_models %}
            <option value="{{ m }}" {{ "selected" if filters.embed==m else "" }}>{{ m }}</option>
          {% endfor %}
        </select>
      </div>

      <div class="sm:col-span-4 flex gap-2">
        <button class="btn btn-primary">Apply</button>
        <a href="/admin/rags" class="btn">Reset</a>
      </div>
    </form>
  </div>

  <div class="card tablewrap">
    
      <table class="w-full text-sm text-left text-gray-600">
        <thead class="text-xs text-gray-700 uppercase bg-gray-50">
          <tr>
            <th class="px-4 py-3">Name</th>
            <th class="px-4 py-3">Scope</th>
            <th class="px-4 py-3">Owner</th>
            <th class="px-4 py-3">Doc count</th>
            <th class="px-4 py-3">Embedding</th>
            <th class="px-4 py-3">Updated</th>
          </tr>
        </thead>
        <tbody>
        {% for it in items %}
          <tr class="border-t">
            <td class="px-4 py-3 text-gray-900 font-medium">{{ it.name }}</td>
            <td class="px-4 py-3"><span class="text-xs px-2 py-1 rounded bg-gray-100">{{ it.scope }}</span></td>
            <td class="px-4 py-3 text-xs text-gray-700">{{ it.owner }}</td>
            <td class="px-4 py-3">{{ it.doc_count }}</td>
            <td class="px-4 py-3 text-xs">{{ it.embed_model }}</td>
            <td class="px-4 py-3 text-xs text-gray-500">{{ it.updated_at }}</td>
          </tr>
        {% endfor %}
        {% if items|length == 0 %}
          <tr><td class="px-4 py-6 text-gray-500" colspan="6">No RAGs match the current filters.</td></tr>
        {% endif %}
        </tbody>
      </table>
    </div>
{% endblock %}
